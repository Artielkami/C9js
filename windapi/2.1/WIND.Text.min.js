WIND.Text=function(e,t){this.type="text";this.top=10;this.left=10;this.width=600;this.height=400;this.color="#0033CC";this.border="#0033CC 2px solid";this.name="Text Displayer";this.icon=lib_path+"images/tvizicon.png";this.draggable=false;this.resizable=false;this.header=false;this.removable=false;this.configurable=false;this.config=false;wind_text=true;this.tool=new Array;if(t.draggable==true)this.draggable=t.draggable;if(t.resizable==true)this.resizable=t.resizable;if(t.header==true)this.header=t.header;if(t.removable==true)this.removable=t.removable;if(t.configurable==true)this.configurable=t.configurable;if(t.config==true)this.config=t.config;if(this.draggable==true||this.removable==true||this.configurable==true||this.config==true)this.header=true;var n=document.createElement("div");n.id=e+"Outer";n.style.position="absolute";if(t.top)this.top=t.top;n.style.top=this.top+"px";if(t.left)this.left=t.left;n.style.left=this.left+"px";if(t.width)this.width=t.width;n.style.width=this.width+"px";if(t.height)this.height=t.height;n.style.height=this.height+"px";if(t.color)this.color=t.color;if(t.border)this.border=t.border;n.style.border=this.border;if(t.parentEl)this.parentEl=t.parentEl;if(t.name)this.name=t.name;if(t.icon)this.icon=t.icon;var r;if(document.getElementById(e))r=document.getElementById(e);else{r=document.createElement("div");r.id=e}r.style.position="absolute";r.style.bottom="2px";r.style.overflow="auto";r.style.width="100%";if(this.header)r.style.height="85%";else r.style.height="100%";r.style.whiteSpace="normal";n.appendChild(r);if(t.parentEl){this.parentEl=t.parentEl;document.getElementById(t.parentEl).appendChild(n)}else document.body.appendChild(n);if(this.header){var i=document.createElement("div");i.id=e+"Handle";i.style.position="absolute";i.style.width="100%";i.style.height="20px";i.style.backgroundColor=this.color;if(this.draggable)i.style.cursor="move";i.style.zIndex=2;var s=document.createElement("img");s.src=this.icon;s.alt="[ ]";s.title="TextDisplayer";s.style.cssFloat="left";i.appendChild(s);var o=document.createElement("span");o.style.color="#FFFFFF";o.style.paddingLeft="3px";o.appendChild(document.createTextNode(this.name));i.appendChild(o);var u=document.createElement("div");u.id=e+"Configuration";u.style.position="absolute";u.style.width="100%";u.style.marginTop="20px";u.style.backgroundColor="#E4E4E4";u.style.zIndex=2;u.style.display="none";n.appendChild(u);var a=this;var f=document.createElement("span");f.appendChild(document.createTextNode("Name: "));u.appendChild(f);var l=document.createElement("input");l.type="text";l.id=e+"Configuration_Name";l.name=e+"Configuration_Name";l.size="30";l.value=this.name;u.appendChild(l);l.onblur=function(){var t=document.getElementById(e+"Configuration_Name").value;if(t!=null&&t!=""){a.name=t;o.removeChild(o.firstChild);o.appendChild(document.createTextNode(a.name))}a.eventConfigured.fire(a)};u.appendChild(document.createElement("br"));var c=document.createElement("span");c.appendChild(document.createTextNode("Color: "));u.appendChild(c);var h=document.createElement("select");h.id=e+"Configuration_Color";h.name=e+"Configuration_Color";u.appendChild(h);h.style.background=this.color;var p=["#00248E","#0033CC","#809FFE","#BFCFFE","#12127D","#1919B3","#9191FE","#C8C8FE","#24006B","#330099","#AA80FE","#D4BFFE","#2D006B","#400099","#B580FE","#DABFFE","#47006B","#660099","#D580FE","#EABFFE","#6B006B","#990099","#FF80FE","#FFBFFE","#8E006B","#CC0099","#FE80DF","#FEBFEF","#A10048","#E60066","#FE80B9","#FEBFDC","#B20000","#FF0000","#FE8080","#FEBFBF","#B22400","#FF3300","#FE9980","#FECCBF","#B24700","#FF6600","#FEB380","#FED9BF","#B25900","#FF8000","#FEBF80","#FEDFBF","#B26B00","#FF9900","#FECC80","#FEE6BF","#B27D00","#FFB200","#FED980","#FEECBF","#B28F00","#FFCC00","#FEE680","#FEF2BF","#B2A100","#FFE500","#FEF280","#FEF9BF","#B2B300","#FFFF00","#FEFF80","#FEFFBF","#8FB200","#CCFF00","#E6FE80","#F2FEBF","#6BB200","#99FF00","#CCFE80","#E6FEBF","#24B200","#33FF00","#99FE80","#CCFEBF","#008E00","#00CC00","#80FE80","#BFFEBF","#007D47","#00B366","#80FEC8","#BFFEE3","#006B6B","#009999","#80FFFE","#BFFFFE","#00477D","#0066B3","#80C8FE","#BFE3FE"];for(var d=0;d<p.length;d++){var v=new Option(p[d],p[d]);v.style.background=p[d];v.style.position="absolute";v.style.width="100px";v.style.height="30px";if(p[d]==this.color)v.selected=true;h.add(v)}h.onchange=function(){h.style.background=this.options[this.selectedIndex].value;a.color=this.options[this.selectedIndex].value;a.border=this.options[this.selectedIndex].value+" 2px solid";document.getElementById(e+"Handle").style.backgroundColor=a.color;document.getElementById(e+"Outer").style.border=a.border};u.appendChild(document.createElement("br"));if(!this.config){var m=document.createElement("span");m.appendChild(document.createTextNode("Editable: "));u.appendChild(m);var g=document.createElement("input");g.type="checkbox";g.id=e+"Configuration_Editable";g.name=e+"Configuration_Editable";u.appendChild(g);u.appendChild(document.createElement("br"));var y=document.createElement("input");y.type="button";y.id=e+"Configuration_Tool";y.name=e+"Configuration_Tool";y.value="Create a new tool";u.appendChild(y);y.onclick=function(){var e=prompt("Name of tool:","Tool");if(e!=null){var t=prompt("Description of tool:","Select word(s).");if(t!=null){var n=prompt("Color of tool:","blue");if(n!=null){var r=new WIND.Text.MagicButton(e,t,"bottom",null,n);a.addTool(r);a.tool.push({rdftype:"http://erozate.iutbayonne.univ-pau.fr/wind#Button",name:e,description:t,position:"bottom",semantics:"unknown",color:n})}}}};u.appendChild(document.createElement("br"));u.appendChild(document.createElement("br"))}this.eventConfigured=new YAHOO.util.CustomEvent("eventConfigured");this.eventConfigured.subscribe(this.onConfigure,this,true);var b=document.createElement("input");b.type="button";b.id=e+"Configuration_Cancel";b.name=e+"Configuration_Cancel";b.value="Close";u.appendChild(b);b.onclick=function(){u.style.display="none"};if(this.removable){this.eventRemoved=new YAHOO.util.CustomEvent("eventRemoved");var w=document.createElement("img");w.src=lib_path+"images/close.png";w.alt="X";w.title="Click to delete";w.style.backgroundColor="#EFEFEF";w.style.cssFloat="right";w.style.cursor="pointer";i.appendChild(w);w.onclick=function(){if(confirm("Do you really want to delete it?")){a.destroy();a.eventRemoved.fire(a)}};this.eventRemoved.subscribe(this.onRemove,this,true)}if(this.configurable){var E=document.createElement("img");E.src=lib_path+"images/gear.png";E.alt="*";E.title="Click to configure";E.style.cssFloat="right";E.style.marginRight="10px";E.style.cursor="pointer";i.appendChild(E);E.onclick=function(){u.style.display="block"}}if(this.config){var E=document.createElement("img");E.src=lib_path+"images/gear.png";E.alt="*";E.title="Click to configure";E.style.cssFloat="right";E.style.marginRight="10px";E.style.cursor="pointer";i.appendChild(E);E.onclick=function(){u.style.display="block"}}n.appendChild(i);if(this.draggable){var S=new YAHOO.util.DD(e+"Outer");S.setHandleElId(e+"Handle");this.eventDragged=new YAHOO.util.CustomEvent("eventDragged");S.on("endDragEvent",function(e){this.eventDragged.fire(this)},this,true);this.eventDragged.subscribe(this.onDrag,this,true);if(t.parentEl){var x=document.getElementById(t.parentEl);var T=n.offsetLeft-x.offsetLeft;var N=x.offsetLeft+x.offsetWidth-n.offsetLeft-n.offsetWidth;var C=n.offsetTop-x.offsetTop;var k=x.offsetTop+x.offsetHeight-n.offsetTop-n.offsetHeight;S.setXConstraint(T,N);S.setYConstraint(C)}else{var T=n.offsetLeft;var C=n.offsetTop;S.setXConstraint(T);S.setYConstraint(C)}}}if(this.resizable){var L=document.createElement("div");L.id="yui-gen0";L.className="yui-resize-handle yui-resize-handle-r";var A=document.createElement("div");A.className="yui-resize-handle-inner-r";L.appendChild(A);n.appendChild(L);var L=document.createElement("div");L.id="yui-gen1";L.className="yui-resize-handle yui-resize-handle-b";var A=document.createElement("div");A.className="yui-resize-handle-inner-b";L.appendChild(A);n.appendChild(L);var L=document.createElement("div");L.id="yui-gen2";L.className="yui-resize-handle yui-resize-handle-br";var A=document.createElement("div");A.className="yui-resize-handle-inner-br";L.appendChild(A);n.appendChild(L);var O=new YAHOO.util.Resize(e+"Outer",{minWidth:10,minHeight:10,maxWidth:1200,maxHeight:800});this.eventResized=new YAHOO.util.CustomEvent("eventResized");O.on("endResize",function(e){this.eventResized.fire(this)},this,true);this.eventResized.subscribe(this.onResize,this,true)}this.container=e;this.paragraphs=new Array;this.interactionList=new Array;this.parts=new Array;this.annotations=new Array;this.parentDocument=null;this.toolbar=null;this.innerText=new Array;this.editable=false};WIND.Text.prototype.destroy=function(){var e=document.getElementById(this.container+"Outer");if(this.parentEl){var t=[];for(var n=0;n<this.parentDocument.viewers.length;n++){if(this.parentDocument.viewers[n].container!=this.container){t.push(this.parentDocument.viewers[n])}}this.parentDocument.viewers=t;document.getElementById(this.parentEl).removeChild(e)}else document.body.removeChild(e)};WIND.Text.prototype.onDrag=function(){this.top=document.getElementById(this.container+"Outer").offsetTop;this.left=document.getElementById(this.container+"Outer").offsetLeft};WIND.Text.prototype.onResize=function(){this.width=document.getElementById(this.container+"Outer").offsetWidth;this.height=document.getElementById(this.container+"Outer").offsetHeight};WIND.Text.prototype.onConfigure=function(){};WIND.Text.prototype.onRemove=function(){};WIND.Text.prototype.addToolBar=function(){if(this.toolbar==null){var e=document.createElement("div");e.style.position="absolute";e.style.top="22px";e.style.right="10px";e.style.zIndex="1000";var t=document.createElement("input");t.type="button";t.title="Bold";t.style.height="24px";t.style.width="30px";t.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px 2px";t.style.border="#808080 1px solid";t.style.cursor="pointer";e.appendChild(t);var n=document.createElement("input");n.type="button";n.title="Italic";n.style.height="24px";n.style.width="30px";n.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -34px";n.style.border="#808080 1px solid";n.style.cursor="pointer";e.appendChild(n);var r=document.createElement("input");r.type="button";r.title="Underline";r.style.height="24px";r.style.width="30px";r.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -70px";r.style.border="#808080 1px solid";r.style.cursor="pointer";e.appendChild(r);var i=document.createElement("input");i.type="button";i.title="Strike Through";i.style.height="24px";i.style.width="30px";i.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -106px";i.style.border="#808080 1px solid";i.style.cursor="pointer";e.appendChild(i);var s=document.createElement("input");s.type="button";s.title="Font Color";s.style.height="24px";s.style.width="30px";s.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -214px";s.style.border="#808080 1px solid";s.style.cursor="pointer";e.appendChild(s);var o=document.createElement("input");o.type="button";o.title="Background Color";o.style.height="24px";o.style.width="30px";o.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -286px";o.style.border="#808080 1px solid";o.style.cursor="pointer";e.appendChild(o);document.getElementById(this.container+"Outer").appendChild(e);this.toolbar=e}else this.toolbar.style.visibility="visible"};WIND.Text.prototype.removeToolBar=function(){if(this.toolbar!=null)this.toolbar.style.visibility="hidden"};WIND.Text.prototype.addAnnotation=function(e){var t=false;for(var n=0;n<e.annotedObjects.length;n++){if(e.annotedObjects.type=="text"){t=true;break}}this.annotations.push(e)};WIND.Text.prototype.createAnnotation=function(e,t,n,r,i,s){var o=this.createSensiblePart(n,r,i,s);var u=new WIND.Annotation(e,t,o);this.annotations.push(u);return u};WIND.Text.prototype.getValue=function(){return{id:this.container,ref:this.ref,type:"TextComponent",rdftype:"http://erozate.iutbayonne.univ-pau.fr/wind#TextComponent",name:this.name,innerText:this.innerText,position:{top:this.top,left:this.left},size:{width:this.width,height:this.height},style:{color:this.color,border:this.border,icon:this.icon},annotation:this.annotation,display:this.display,load:this.load,tool:this.tool,parameter:{draggable:this.draggable?"yes":"no",resizable:this.resizable?"yes":"no",removable:this.removable?"yes":"no",configurable:this.configurable?"yes":"no",header:this.header?"yes":"no",toolbar:"no"}}};WIND.Text.prototype.activateInteractions_=function(){for(var e=0;e<this.interactionList.length;e++){this.activateInteraction(this.interactionList[e])}};WIND.Text.prototype.activateInteraction_=function(e){var t=e.event;var n=e.reactions;if(t instanceof WIND.SelectEvent){if(t.annotationSelected instanceof WIND.Selection){for(var r=0;r<t.annotationSelected.set.length;r++){var i=t.annotationSelected.set[r];for(var s=0;s<i.annotedObjects.length;s++){i.annotedObjects[s].setStyle("color:#0033CC;text-decoration:underline;cursor:pointer");this.addListener(i.annotedObjects[s].object,t.event_type,function(n){var r=YAHOO.util.Event.getTarget(n);var i;for(var s=0;s<t.annotationSelected.set.length;s++){var o=t.annotationSelected.set[s];for(var u=0;u<o.annotedObjects.length;u++){if(o.annotedObjects[u].object==r.id){i=o;break}}}if(i){e.runReactions()}})}}}else{e.runReactions()}}else if(t instanceof WIND.InputEvent){e.runReactions()}};WIND.Text.prototype.activateInteraction2=function(e){var t=e.source;var n=e.event;var r=e.reactions;var i=this;if(t instanceof Array){for(var s=0;s<t.length;s++){this.addListener(t[s].object,n,function(e){for(var t=0;t<r.length;t++){var n=r[t].target;if(n instanceof WIND.LiveSensiblePart){var s=YAHOO.util.Event.getTarget(e);var o;for(var u=0;u<i.parts.length;u++){if(i.parts[u].object==s.id){o=i.parts[u];break}}if(o){var a=n.viewer;var f=n.func;var l=a.annotations;for(var c=0;c<l.length;c++){if(l[c].semantics==o.annotation.semantics&&l[c].entity==o.annotation.entity){if(f=="prefecture_of_town"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i;if(a instanceof WIND.Map){i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Prefecture",n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#0033CC,strokeWidth:2,fillColor:#809FFE"})}else if(a instanceof WIND.Text){var s=document.getElementById(a.container);while(s.firstChild){s.removeChild(s.firstChild)}document.getElementById(a.container).innerHTML="";a.paragraphs=[];var o=a.createParagraph();o.setContent(n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue);i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Prefecture",n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue,1,1,1)}var u=i.annotedObjects;for(var f=0;f<u.length;f++){u[f].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/prefecture_of_town.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else if(f=="prefecture_of_department"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i;if(a instanceof WIND.Map){i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Prefecture",n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#0033CC,strokeWidth:2,fillColor:#809FFE"})}else if(a instanceof WIND.Text){var s=document.getElementById(a.container);while(s.firstChild){s.removeChild(s.firstChild)}document.getElementById(a.container).innerHTML="";a.paragraphs=[];var o=a.createParagraph();o.setContent(n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue);i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Prefecture",n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue,1,1,1)}var u=i.annotedObjects;for(var f=0;f<u.length;f++){u[f].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/prefecture_of_department.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else if(f=="department_of_town"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i;if(a instanceof WIND.Map){i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Department",n.getElementsByTagName("nom_dept")[0].childNodes[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#0033CC,strokeWidth:2,fillColor:#809FFE"})}else if(a instanceof WIND.Text){var s=document.getElementById(a.container);while(s.firstChild){s.removeChild(s.firstChild)}document.getElementById(a.container).innerHTML="";a.paragraphs=[];var o=a.createParagraph();o.setContent(n.getElementsByTagName("nom_dept")[0].childNodes[0].nodeValue);i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Department",n.getElementsByTagName("nom_dept")[0].childNodes[0].nodeValue,1,1,1)}var u=i.annotedObjects;for(var f=0;f<u.length;f++){u[f].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/department_of_town.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else{var p=l[c].annotedObjects;for(var d=0;d<p.length;d++){p[d].callFunction(r[t].calledFunction,r[t].parameters)}}break}}}}else{n.callFunction(r[t].calledFunction,r[t].parameters)}}})}}else{this.addListener(t.object,n,function(e){for(var t=0;t<r.length;t++){var n=r[t].target;if(n instanceof WIND.LiveSensiblePart){var s=YAHOO.util.Event.getTarget(e);var o;for(var u=0;u<i.parts.length;u++){if(i.parts[u].object==s.id){o=i.parts[u];break}}if(o){var a=n.viewer;var f=n.func;var l=a.annotations;for(var c=0;c<l.length;c++){if(l[c].semantics==o.annotation.semantics&&l[c].entity==o.annotation.entity){if(f=="prefecture_of_town"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i;if(a instanceof WIND.Map){i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Department",n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#0033CC,strokeWidth:2,fillColor:#809FFE"})}else if(a instanceof WIND.Text){var s=document.getElementById(a.container);while(s.firstChild){s.removeChild(s.firstChild)}document.getElementById(a.container).innerHTML="";a.paragraphs=[];var o=a.createParagraph();o.setContent(n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue);i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Department",n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue,1,1,1)}var u=i.annotedObjects;for(var f=0;f<u.length;f++){u[f].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/prefecture_of_town.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else if(f=="prefecture_of_department"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i;if(a instanceof WIND.Map){i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Department",n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#0033CC,strokeWidth:2,fillColor:#809FFE"})}else if(a instanceof WIND.Text){var s=document.getElementById(a.container);while(s.firstChild){s.removeChild(s.firstChild)}document.getElementById(a.container).innerHTML="";a.paragraphs=[];var o=a.createParagraph();o.setContent(n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue);i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Department",n.getElementsByTagName("nom_chf_l")[0].childNodes[0].nodeValue,1,1,1)}var u=i.annotedObjects;for(var f=0;f<u.length;f++){u[f].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/prefecture_of_department.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else if(f=="department_of_town"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i;if(a instanceof WIND.Map){i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Department",n.getElementsByTagName("nom_dept")[0].childNodes[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#0033CC,strokeWidth:2,fillColor:#809FFE"})}else if(a instanceof WIND.Text){var s=document.getElementById(a.container);while(s.firstChild){s.removeChild(s.firstChild)}document.getElementById(a.container).innerHTML="";a.paragraphs=[];var o=a.createParagraph();o.setContent(n.getElementsByTagName("nom_dept")[0].childNodes[0].nodeValue);i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Department",n.getElementsByTagName("nom_dept")[0].childNodes[0].nodeValue,1,1,1)}var u=i.annotedObjects;for(var f=0;f<u.length;f++){u[f].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/department_of_town.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else{var p=l[c].annotedObjects;for(var d=0;d<p.length;d++){p[d].callFunction(r[t].calledFunction,r[t].parameters)}}break}}}}else{n.callFunction(r[t].calledFunction,r[t].parameters)}}})}};WIND.Text.prototype.addListener=function(e,t,n){if(document.getElementById(e)){if(t=="click"){document.getElementById(e).onclick=n}else if(t=="mouseover"){document.getElementById(e).onmouseover=n}else if(t=="mouseout"){document.getElementById(e).onmouseout=n}}};WIND.Text.prototype.loadRDFFile=function(e,t){var n=createXHR();n.open("GET",e+"?rdf="+t,false);n.send(null);if(n.status==200){var r=YAHOO.lang.JSON.parse(n.responseText);var i=r.paragraphs;for(var s=0;s<i.length;s++){var o=true;for(var u=0;u<this.paragraphs.length;u++){if(this.paragraphs[u].text==i[s]){o=false;break}}if(o){var a=this.createParagraph();a.setContent(i[s]);this.innerText.push({ref:t})}}var f=r.annotations;for(var s=0;s<f.length;s++){var l=[];var c=f[s].position;for(var u=0;u<c.length;u++){for(var h=0;h<this.paragraphs.length;h++){if(this.paragraphs[h].text==i[c[u].paragraph-1]){c[u].paragraph=h+1;break}}var p=this.createSensiblePart(c[u].paragraph,c[u].start,c[u].end);for(var d=0;d<p.length;d++){p[d].setStyle("text-decoration:underline");l.push(p[d])}}}}else{document.getElementById(this.container).innerHTML="Error: "+t+" "+n.status+" "+n.statusText}};WIND.Text.Part=function(e){this.object=e;this.paragraph=null;this.tokenId=null;this.word=null};WIND.Text.Part.prototype=new WIND.SensiblePart("text");WIND.Text.Part.prototype.highlight=function(){var e=document.getElementById(this.object);if(e){e.style.backgroundColor="blue";e.style.color="white"}};WIND.Text.Part.prototype.bold=function(){var e=document.getElementById(this.object);if(e){e.style.fontWeight="bold"}};WIND.Text.Part.prototype.italicize=function(){var e=document.getElementById(this.object);if(e){e.style.fontStyle="italic"}};WIND.Text.Part.prototype.underline=function(){var e=document.getElementById(this.object);if(e){e.style.textDecoration="underline"}};WIND.Text.Part.prototype.blink=function(){var e=document.getElementById(this.object);if(e){e.style.textDecoration="blink"}};WIND.Text.Part.prototype.setStyleByClass=function(e){var t=document.getElementById(this.object);if(t){t.className=e}};WIND.Text.Part.prototype.setStyle=function(e){var t=document.getElementById(this.object);if(t){var n=e.split(";");var r;t.style.whiteSpace="pre";for(var i=0;i<n.length;i++){r=n[i];if(r.split(":")[0]=="color")t.style.color=r.split(":")[1];if(r.split(":")[0]=="background-color")t.style.backgroundColor=r.split(":")[1];if(r.split(":")[0]=="font-weight")t.style.fontWeight=r.split(":")[1];if(r.split(":")[0]=="font-style")t.style.fontStyle=r.split(":")[1];if(r.split(":")[0]=="font-size")t.style.fontSize=r.split(":")[1];if(r.split(":")[0]=="text-decoration")t.style.textDecoration=r.split(":")[1];if(r.split(":")[0]=="cursor")t.style.cursor=r.split(":")[1];if(r.split(":")[0]=="border")t.style.border=r.split(":")[1];if(r.split(":")[0]=="border-top")t.style.borderTop=r.split(":")[1];if(r.split(":")[0]=="border-right")t.style.borderRight=r.split(":")[1];if(r.split(":")[0]=="border-bottom")t.style.borderBottom=r.split(":")[1];if(r.split(":")[0]=="border-left")t.style.borderLeft=r.split(":")[1];if(r.split(":")[0]=="padding")t.style.padding=r.split(":")[1]}}};WIND.Text.Part.prototype.show=function(){var e=document.getElementById(this.object);if(e){e.style.display="block"}};WIND.Text.Part.prototype.hide=function(){var e=document.getElementById(this.object);if(e){e.style.display="none"}};WIND.Text.Part.prototype.setDraggable=function(e,t){var n=document.getElementById(this.object);if(n){var r=new WIND.Annotation2DisplayerProxy(this.object,e,t);r._part=this;var i=new YAHOO.util.DDTarget(t.container,"Annotation2Displayer")}};WIND.Text.Part.prototype.onDrag=function(){};WIND.Text.Part.prototype.window=function(e){var t=new Widget.Dialog;t.alert(e)};WIND.Text.Paragraph=function(e){this.object=e;this.words=[];this.text=null};WIND.Text.Paragraph.prototype=new WIND.Text.Part(this.object);WIND.Text.prototype.createParagraph=function(e){var t=this.paragraphs.length+1;var n=document.createElement("div");n.id=this.container+"_paragraph"+t;n.style.margin="10px";n.style.textAlign="left";if(e){if(e.display)n.style.display="block";else n.style.display="none"}else n.style.display="block";document.getElementById(this.container).appendChild(n);var r=new WIND.Text.Paragraph(this.container+"_paragraph"+t);this.paragraphs.push(r);return r};WIND.Text.tokenizer=function(e){var t=e.split(" ");var n,r;var i=[];for(var s=0;s<t.length;s++){if(t[s].indexOf("'")!=-1){n=t[s].split("'")[0]+"'";r=t[s].split("'")[1];i=t.slice(0,s);i.push(n);i.push(r);i=i.concat(t.slice(s+1,t.length));t=i}}for(var s=0;s<t.length;s++){if(t[s].length>1&&t[s].indexOf(",")!=-1){n=t[s].substring(0,t[s].length-1);r=",";i=t.slice(0,s);i.push(n);i.push(r);i=i.concat(t.slice(s+1,t.length));t=i}}for(var s=0;s<t.length;s++){if(t[s].length>1&&t[s].indexOf(".")!=-1){n=t[s].substring(0,t[s].length-1);r=".";i=t.slice(0,s);i.push(n);i.push(r);i=i.concat(t.slice(s+1,t.length));t=i}}for(var s=0;s<t.length;s++){if(t[s].length>1&&t[s].indexOf(":")!=-1&&t[s].lastIndexOf(":")==t[s].length-1){n=t[s].substring(0,t[s].length-1);r=":";i=t.slice(0,s);i.push(n);i.push(r);i=i.concat(t.slice(s+1,t.length));t=i}}for(var s=0;s<t.length;s++){if(t[s].length>1&&t[s].indexOf("(")!=-1){n="(";r=t[s].substring(1);i=t.slice(0,s);i.push(n);i.push(r);i=i.concat(t.slice(s+1,t.length));t=i}}for(var s=0;s<t.length;s++){if(t[s].length>1&&t[s].indexOf(")")!=-1){n=t[s].substring(0,t[s].length-1);r=")";i=t.slice(0,s);i.push(n);i.push(r);i=i.concat(t.slice(s+1,t.length));t=i}}return t};WIND.Text.Paragraph.prototype.setContent=function(e){this.text=e;var t=document.getElementById(this.object);while(t.firstChild){t.removeChild(t.firstChild)}this.words=WIND.Text.tokenizer(e);var n,r;for(var i=0;i<this.words.length;i++){n=document.createElement("span");n.id=this.object+"_token"+(i+1);n.appendChild(document.createTextNode(this.words[i]));t.appendChild(n);if(this.words[i].indexOf("'")==-1){n=document.createElement("span");n.id=this.object+"_espace"+(i+1)+"_"+(i+2);n.appendChild(document.createTextNode(" "));t.appendChild(n)}if(this.words[i]==","||this.words[i]=="."||this.words[i]==":"){r=this.object+"_espace"+i+"_"+(i+1);n=document.getElementById(r);t.removeChild(n)}}};WIND.Text.Paragraph.prototype.setContentByArray=function(e){var t="";for(var n=0;n<e.length;n++){if(e[n]=="."||e[n]==","||e[n]==":"){t=t.substring(0,t.length-1)}if(e[n].indexOf("'")==-1){t+=e[n]+" "}else{t+=e[n]}}this.text=t;var r=document.getElementById(this.object);this.words=e;var i,s;for(var n=0;n<this.words.length;n++){i=document.createElement("span");i.id=this.object+"_token"+(n+1);i.appendChild(document.createTextNode(this.words[n]));r.appendChild(i);if(this.words[n].indexOf("'")==-1){i=document.createElement("span");i.id=this.object+"_espace"+(n+1)+"_"+(n+2);i.appendChild(document.createTextNode(" "));r.appendChild(i)}if(this.words[n]==","||this.words[n]=="."||this.words[n]==":"){s=this.object+"_espace"+n+"_"+(n+1);i=document.getElementById(s);r.removeChild(i)}}};WIND.Text.prototype.createSensiblePart=function(e,t,n,r){var i,s;var o=new Array();for(var u=Number(t);u<=Number(n);u++){i=this.container+"_paragraph"+e+"_token"+u;s=new WIND.Text.Part(i);s.viewer=this;s.paragraph=e;s.tokenId=u;s.word=this.paragraphs[e-1].words[u-1];o.push(s);this.parts.push(s)}for(var u=Number(t);u<Number(n);u++){i=this.container+"_paragraph"+e+"_espace"+u+"_"+(u+1);if(document.getElementById(i)){s=new WIND.Text.Part(i);s.viewer=this;s.paragraph=e;o.push(s);this.parts.push(s)}}if(r&&r.style){for(var u=0;u<o.length;u++){o[u].setStyle(r.style)}}return o};WIND.Text.prototype.createSensiblePartByWord=function(e,t){var n;var r=[];var i,s;var o=WIND.Text.tokenizer(e);var u;for(var a=0;a<this.paragraphs.length;a++){n=this.paragraphs[a].words;for(var f=0;f<n.length-o.length;f++){u=true;for(var l=0;l<o.length;l++){if(!(n[f+l]==o[l])){u=false;break}}if(u){for(var l=0;l<o.length;l++){i=this.container+"_paragraph"+(a+1)+"_token"+(f+l+1);s=new WIND.Text.Part(i);s.viewer=this;r.push(s);this.parts.push(s)}}}}if(t&&t.style){for(var a=0;a<r.length;a++){r[a].setStyle(t.style)}}else{for(var a=0;a<r.length;a++){r[a].setStyle("color:blue;text-decoration:underline")}}return r};WIND.Text.MagicButton=function(e,t,n,r,i){this.name=e;this.description=t;this.position=n;this.semantics=r;this.color=i;this.parentComponent=null;this.button=null};WIND.Text.MagicButton.prototype=new WIND.Tool("text");WIND.Text.MagicButton.prototype.activate=function(){this.button.set("disabled",false)};WIND.Text.MagicButton.prototype.desactivate=function(){this.button.set("disabled",true)};WIND.Text.prototype.addTool=function(e){if(this.bottomDiv==null){var t=document.createElement("div");t.id=this.container+"-bottom";t.style.position="absolute";t.style.bottom="0px";t.style.left="0px";t.style.width="100%";this.bottomDiv=t;document.getElementById(this.container).appendChild(this.bottomDiv)}if(e.position=="bottom"){e.button=new YAHOO.widget.Button({id:"mybutton",label:e.name,title:e.description,menuclassname:"yui-button",type:"checkbox",container:this.bottomDiv,disabled:true})}e.parentComponent=this}