WIND.Calendar=function(e,t){this.draggable=false;this.resizable=false;this.top=10;this.left=10;this.width=600;this.height=400;this.color="#3366CC";this.border="#3366CC 2px solid";this.name="Calendar Displayer";this.icon=lib_path+"images/cvizicon.png";this.header=false;this.removable=false;this.configurable=false;if(t.draggable==true)this.draggable=t.draggable;if(t.resizable==true)this.resizable=t.resizable;if(t.header==true)this.header=t.header;if(t.removable==true)this.removable=t.removable;if(t.configurable==true)this.configurable=t.configurable;if(this.draggable==true||this.removable==true||this.configurable==true)this.header=true;var n=document.createElement("div");n.id=e+"Outer";n.style.position="absolute";if(t.top)this.top=t.top;n.style.top=this.top+"px";if(t.left)this.left=t.left;n.style.left=this.left+"px";if(t.width)this.width=t.width;n.style.width=this.width+"px";if(t.height)this.height=t.height;n.style.height=this.height+"px";if(t.color)this.color=t.color;if(t.border)this.border=t.border;n.style.border=this.border;if(t.parentEl)this.parentEl=t.parentEl;if(t.name)this.name=t.name;if(t.icon)this.icon=t.icon;var r=document.createElement("div");r.id=e+"navControlDiv";r.className="navControl";r.style.position="absolute";r.style.top="22px";r.style.left="2px";n.appendChild(r);var i=document.createElement("div");i.id=e+"viewControlDiv";i.className="viewControl";i.style.position="absolute";i.style.top="22px";i.style.right="2px";n.appendChild(i);var s;if(document.getElementById(e))s=document.getElementById(e);else{s=document.createElement("div");s.id=e}s.style.position="absolute";s.style.bottom="2px";s.style.width="100%";if(this.header)s.style.height="90%";else s.style.height="100%";n.appendChild(s);if(t.parentEl){this.parentEl=t.parentEl;document.getElementById(t.parentEl).appendChild(n)}else document.body.appendChild(n);if(this.header){var o=document.createElement("div");o.id=e+"Handle";o.style.position="absolute";o.style.width="100%";o.style.height="20px";o.style.backgroundColor=this.color;if(this.draggable)o.style.cursor="move";o.style.zIndex=2;var u=document.createElement("img");u.src=this.icon;u.alt="[ ]";u.title="CalendarDisplayer";u.style.cssFloat="left";o.appendChild(u);var a=document.createElement("span");a.style.color="#FFFFFF";a.style.paddingLeft="3px";a.appendChild(document.createTextNode(this.name));o.appendChild(a);var f=document.createElement("div");f.id=e+"Configuration";f.style.position="absolute";f.style.width="100%";f.style.marginTop="20px";f.style.backgroundColor="#E4E4E4";f.style.zIndex=2;f.style.display="none";n.appendChild(f);var l=document.createElement("span");l.appendChild(document.createTextNode("Name of displayer: "));f.appendChild(l);f.appendChild(document.createElement("br"));var c=document.createElement("input");c.type="text";c.id=e+"Configuration_Name";c.name=e+"Configuration_Name";c.size="30";f.appendChild(c);f.appendChild(document.createElement("br"));var h=document.createElement("input");h.type="button";h.id=e+"Configuration_OK";h.name=e+"Configuration_OK";h.value="OK";f.appendChild(h);this.eventConfigured=new YAHOO.util.CustomEvent("eventConfigured");var p=this;h.onclick=function(){var t=document.getElementById(e+"Configuration_Name").value;if(t!=null&&t!=""){p.name=t;a.removeChild(a.firstChild);a.appendChild(document.createTextNode(p.name))}f.style.display="none";p.eventConfigured.fire(p)};this.eventConfigured.subscribe(this.onConfigure,this,true);var d=document.createElement("input");d.type="button";d.id=e+"Configuration_Cancel";d.name=e+"Configuration_Cancel";d.value="Cancel";f.appendChild(d);d.onclick=function(){f.style.display="none"};if(this.removable){this.eventRemoved=new YAHOO.util.CustomEvent("eventRemoved");var v=document.createElement("img");v.src=lib_path+"images/close.png";v.alt="X";v.title="Delete";v.style.backgroundColor="#EFEFEF";v.style.cssFloat="right";v.style.cursor="pointer";o.appendChild(v);var p=this;v.onclick=function(){if(confirm("Do you really want to delete it?")){p.destroy();p.eventRemoved.fire(p)}};this.eventRemoved.subscribe(this.onRemove,this,true)}if(this.configurable){var m=document.createElement("img");m.src=lib_path+"images/gear.png";m.alt="*";m.title="Preferences";m.style.cssFloat="right";m.style.marginRight="10px";m.style.cursor="pointer";o.appendChild(m);m.onclick=function(){f.style.display="block"}}n.appendChild(o);if(this.draggable){var g=new YAHOO.util.DD(e+"Outer");g.setHandleElId(e+"Handle");this.eventDragged=new YAHOO.util.CustomEvent("eventDragged");g.on("endDragEvent",function(e){this.eventDragged.fire(this)},this,true);this.eventDragged.subscribe(this.onDrag,this,true);if(t.parentEl){var y=document.getElementById(t.parentEl);var b=n.offsetLeft-y.offsetLeft;var w=y.offsetLeft+y.offsetWidth-n.offsetLeft-n.offsetWidth;var E=n.offsetTop-y.offsetTop;var S=y.offsetTop+y.offsetHeight-n.offsetTop-n.offsetHeight;g.setXConstraint(b,w);g.setYConstraint(E)}else{var b=n.offsetLeft;var E=n.offsetTop;g.setXConstraint(b);g.setYConstraint(E)}}}if(this.resizable){var x=document.createElement("div");x.id="yui-gen0";x.className="yui-resize-handle yui-resize-handle-r";var T=document.createElement("div");T.className="yui-resize-handle-inner-r";x.appendChild(T);n.appendChild(x);var x=document.createElement("div");x.id="yui-gen1";x.className="yui-resize-handle yui-resize-handle-b";var T=document.createElement("div");T.className="yui-resize-handle-inner-b";x.appendChild(T);n.appendChild(x);var x=document.createElement("div");x.id="yui-gen2";x.className="yui-resize-handle yui-resize-handle-br";var T=document.createElement("div");T.className="yui-resize-handle-inner-br";x.appendChild(T);n.appendChild(x);var N=new YAHOO.util.Resize(e+"Outer",{minWidth:160,minHeight:160,maxWidth:1200,maxHeight:800});this.eventResized=new YAHOO.util.CustomEvent("eventResized");N.on("endResize",function(e){this.eventResized.fire(this)},this,true);this.eventResized.subscribe(this.onResize,this,true)}this.container=e;this.currentPivotDate=new Date;this.firstDayOfWeek=1;this.viewMode="month";this.interactionList=[];this.parts=[];this.annotations=[];this.parentDocument=null;this.render()};WIND.Calendar.prototype.destroy=function(){var e=document.getElementById(this.container+"Outer");if(this.parentEl){var t=[];for(var n=0;n<this.parentDocument.viewers.length;n++){if(this.parentDocument.viewers[n].container!=this.container){t.push(this.parentDocument.viewers[n])}}this.parentDocument.viewers=t;document.getElementById(this.parentEl).removeChild(e)}else document.body.removeChild(e)};WIND.Calendar.prototype.onDrag=function(){this.top=document.getElementById(this.container+"Outer").offsetTop;this.left=document.getElementById(this.container+"Outer").offsetLeft};WIND.Calendar.prototype.onResize=function(){this.width=document.getElementById(this.container+"Outer").offsetWidth;this.height=document.getElementById(this.container+"Outer").offsetHeight};WIND.Calendar.prototype.onConfigure=function(){};WIND.Calendar.prototype.onRemove=function(){};WIND.Calendar.prototype.activateInteractions=function(){for(var e=0;e<this.parts.length;e++){this.parts[e].setStyle("background-color:#CFDFFE")}for(var e=0;e<this.interactionList.length;e++){this.activateInteraction(this.interactionList[e])}};WIND.Calendar.prototype.activateInteraction=function(e){var t=e.source;var n=e.event;var r=e.reactions;if(t instanceof Array){for(var i=0;i<t.length;i++){this.addListener(t[i].object,n,function(){for(var e=0;e<r.length;e++){r[e].target.callFunction(r[e].calledFunction,r[e].parameters)}})}}else{this.addListener(t.object,n,function(){for(var e=0;e<r.length;e++){r[e].target.callFunction(r[e].calledFunction,r[e].parameters)}})}};WIND.Calendar.prototype.addListener=function(e,t,n){if(document.getElementById(e)){if(t=="click"){document.getElementById(e).style.cursor="pointer";document.getElementById(e).onclick=n}else if(t=="mouseover"){document.getElementById(e).onmouseover=n}else if(t=="mouseout"){document.getElementById(e).onmouseout=n}}};WIND.Calendar.prototype.addAnnotation=function(e){var t=false;for(var n=0;n<e.annotedObjects.length;n++){if(e.annotedObjects.type=="calendar"){t=true;break}}this.annotations.push(e)};WIND.Calendar.prototype.createAnnotation=function(e,t,n,r,i){var s=this.createSensiblePart(n,r,i);var o=new WIND.Annotation(e,t,s);this.annotations.push(o);return o};WIND.Calendar.prototype.getValue=function(){return{id:this.container,ref:this.ref,rdftype:"http://erozate.iutbayonne.univ-pau.fr/wind#CalendarComponent",name:this.name,innerText:this.innerText,position:{top:this.top,left:this.left},size:{width:this.width,height:this.height},style:{color:this.color,border:this.border,icon:this.icon},annotation:this.annotation,display:this.display,load:this.load,parameter:{draggable:this.draggable?"yes":"no",resizable:this.resizable?"yes":"no",removable:this.removable?"yes":"no",configurable:this.configurable?"yes":"no",header:this.header?"yes":"no",toolbar:"no"}}};WIND.Calendar.prototype.getValuetoXML=function(){var e="http://erozate.iutbayonne.univ-pau.fr/wind/";var t=createXMLDocument("Viewer",e);t.documentElement.setAttribute("type","CalendarViewer");t.documentElement.setAttribute("id",this.container);var n=createElementNS(e,"style",t);n.setAttribute("left",this.left);n.setAttribute("top",this.top);n.setAttribute("width",this.width);n.setAttribute("height",this.height);n.setAttribute("color",this.color);t.documentElement.appendChild(n);var r=createElementNS(e,"draggable",t);r.appendChild(t.createTextNode(this.draggable));t.documentElement.appendChild(r);var i=createElementNS(e,"resizable",t);i.appendChild(t.createTextNode(this.resizable));t.documentElement.appendChild(i);var s=createElementNS(e,"mode",t);s.appendChild(t.createTextNode(this.viewMode));t.documentElement.appendChild(s);for(var o=0;o<this.annotations.length;o++){var u=createElementNS(e,"Annotation",t);u.setAttribute("id",this.container+"_annotation"+(o+1));var a=createElementNS(e,"semantics",t);a.appendChild(t.createTextNode(this.annotations[o].semantics));u.appendChild(a);var f=createElementNS(e,"entity",t);f.appendChild(t.createTextNode(this.annotations[o].entity));u.appendChild(f);var l=this.annotations[o];for(var c=0;c<l.annotedObjects.length;c++){var h=l.annotedObjects[c];var p=createElementNS(e,"CalendarPart",t);p.setAttribute("startTime",h.startTime);p.setAttribute("endTime",h.endTime);var d=createElementNS(e,"event",t);d.appendChild(t.createTextNode(h.event));p.appendChild(d);u.appendChild(p)}t.documentElement.appendChild(u)}return t};WIND.Calendar.prototype.getValuetoXMLString=function(){var e=this.getValuetoXML();var t=serializeNode(e);return t};WIND.Calendar.prototype.getValuetoXMLNode=function(e){var t="http://erozate.iutbayonne.univ-pau.fr/wind/";var n=createElementNS(t,"Viewer",e);n.setAttribute("type","CalendarViewer");n.setAttribute("id",this.container);var r=createElementNS(t,"style",e);r.setAttribute("left",this.left);r.setAttribute("top",this.top);r.setAttribute("width",this.width);r.setAttribute("height",this.height);r.setAttribute("color",this.color);n.appendChild(r);var i=createElementNS(t,"draggable",e);i.appendChild(e.createTextNode(this.draggable));n.appendChild(i);var s=createElementNS(t,"resizable",e);s.appendChild(e.createTextNode(this.resizable));n.appendChild(s);var o=createElementNS(t,"mode",e);o.appendChild(e.createTextNode(this.viewMode));n.appendChild(o);for(var u=0;u<this.annotations.length;u++){var a=createElementNS(t,"Annotation",e);a.setAttribute("id",this.container+"_annotation"+(u+1));var f=createElementNS(t,"semantics",e);f.appendChild(e.createTextNode(this.annotations[u].semantics));a.appendChild(f);var l=createElementNS(t,"entity",e);l.appendChild(e.createTextNode(this.annotations[u].entity));a.appendChild(l);var c=this.annotations[u];for(var h=0;h<c.annotedObjects.length;h++){var p=c.annotedObjects[h];var d=createElementNS(t,"CalendarPart",e);d.setAttribute("startTime",p.startTime);d.setAttribute("endTime",p.endTime);var v=createElementNS(t,"event",e);v.appendChild(e.createTextNode(p.event));d.appendChild(v);a.appendChild(d)}n.appendChild(a)}return n};WIND.Calendar.Part=function(e,t,n){this.object=null;this.startTime=e;this.endTime=t;this.event=n};WIND.Calendar.Part.prototype=new WIND.SensiblePart("calendar");WIND.Calendar.Part.prototype.highlight=function(){this.viewer.panToDate(this.object);document.getElementById(this.object).style.backgroundColor="yellow";document.getElementById(this.object).style.border="1px blue solid"};WIND.Calendar.Part.prototype.setStyle=function(e){if(document.getElementById(this.object)){var t=e.split(";");var n;for(var r=0;r<t.length;r++){n=t[r];if(n.split(":")[0]=="color")document.getElementById(this.object).style.color=n.split(":")[1];if(n.split(":")[0]=="background-color")document.getElementById(this.object).style.backgroundColor=n.split(":")[1];if(n.split(":")[0]=="font-weight")document.getElementById(this.object).style.fontWeight=n.split(":")[1];if(n.split(":")[0]=="font-style")document.getElementById(this.object).style.fontStyle=n.split(":")[1];if(n.split(":")[0]=="text-decoration")document.getElementById(this.object).style.textDecoration=n.split(":")[1]}}};WIND.Calendar.MONTHS=["Jan.","Feb.","Mar.","Apr.","May","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."];WIND.Calendar.DAYS=["Sun.","Mon.","Tue.","Wed.","Thu.","Fri.","Sat.","Sun."];WIND.Calendar.calendarViewClass="calendarView";WIND.Calendar.columnHeadingClass="columnDay";WIND.Calendar.weekViewCellClass="weekViewCell";WIND.Calendar.weekViewTodayCellClass="weekViewTodayCell";WIND.Calendar.monthViewCellClass="monthViewCell";WIND.Calendar.monthViewTodayCellClass="monthViewTodayCell";WIND.Calendar.dateClass="date";WIND.Calendar.contentCellClass="contentCell";WIND.Calendar.monthViewButtonLabel="Month";WIND.Calendar.weekViewButtonLabel="Week";WIND.Calendar.todayButtonLabel="Today";WIND.Calendar.prevButtonLabel="<<";WIND.Calendar.nextButtonLabel=">>";WIND.Calendar.prototype.setViewMode=function(e){if(e=="month"||e=="week"){this.viewMode=e;this.render()}};WIND.Calendar.prototype.panToDate=function(e){var t=e.substring(this.container.length,e.length);var n=t.substring(0,4);n=parseInt(n);var r=t.substring(5,7);if(r.startsWith("0"))r=parseInt(t.substring(6,7))-1;else r=parseInt(r)-1;var i=t.substring(8,10);if(i.startsWith("0"))i=parseInt(t.substring(9,10))-1;else i=parseInt(i)-1;var s=new Date(n,r,i);this.currentPivotDate=s;this.render()};WIND.Calendar.prototype.render=function(){switch(this.viewMode){case"week":this.initWeekView();break;case"month":this.initMonthView();break}};WIND.Calendar.prototype.initMonthView=function(){this.initMonthNavControl();this.initMonthViewControl();this.updateMonthView()};WIND.Calendar.prototype.initMonthNavControl=function(){var e=document.getElementById(this.container+"navControlDiv");if(e.hasChildNodes()){while(e.childNodes.length>0){e.removeChild(e.firstChild)}}var t=this;var n=document.createElement("input");n.type="button";n.id=this.container+"todayButton";n.value=WIND.Calendar.todayButtonLabel;e.appendChild(n);var r=document.createTextNode(" ");e.appendChild(r);n.onclick=function(){t.currentPivotDate=new Date;t.updateMonthView()};var i=document.createElement("input");i.type="button";i.id=this.container+"prevMonth";i.value=WIND.Calendar.prevButtonLabel;e.appendChild(i);r=document.createTextNode(" ");e.appendChild(r);i.onclick=function(){var e=t.currentPivotDate.getMonth();t.currentPivotDate.setMonth(e-1);t.updateMonthView()};var s=document.createElement("span");s.id=this.container+"monthHolder";s.innerHTML=WIND.Calendar.MONTHS[this.currentPivotDate.getMonth()];e.appendChild(s);r=document.createTextNode(" ");e.appendChild(r);var o=document.createElement("span");o.id=this.container+"yearHolder";var u=1800;var a=document.createElement("select");a.id=this.container+"yearChooser";for(var f=0;f<300;f++){var l=new Date;a.options[a.options.length]=new Option(u,u);u++}a.onchange=function(){t.currentPivotDate.setFullYear(this.options[this.selectedIndex].value);t.updateMonthView()};o.appendChild(a);e.appendChild(o);r=document.createTextNode(" ");e.appendChild(r);var c=document.createElement("input");c.type="button";c.id=this.container+"nextMonth";c.value=WIND.Calendar.nextButtonLabel;e.appendChild(c);c.onclick=function(){var e=t.currentPivotDate.getMonth();t.currentPivotDate.setMonth(e+1);t.updateMonthView()}};WIND.Calendar.prototype.initMonthViewControl=function(){var e=document.getElementById(this.container+"viewControlDiv");if(e.hasChildNodes()){while(e.childNodes.length>0){e.removeChild(e.firstChild)}}var t=this;var n=document.createElement("input");n.type="button";n.id=this.container+"weekViewButton";n.value=WIND.Calendar.weekViewButtonLabel;e.appendChild(n);var r=document.createTextNode(" ");e.appendChild(r);n.onclick=function(){t.viewMode="week";t.initWeekView()};var i=document.createElement("input");i.type="button";i.id=this.container+"monthViewButton";i.value=WIND.Calendar.monthViewButtonLabel;i.disabled=true;e.appendChild(i)};WIND.Calendar.prototype.updateMonthView=function(){this.initMonthGrid();document.getElementById(this.container+"monthHolder").innerHTML=WIND.Calendar.MONTHS[this.currentPivotDate.getMonth()];var e=document.getElementById(this.container+"yearChooser");var t;for(var n=0;n<e.options.length;n++){var t=e.options[n];if(t.value==this.currentPivotDate.getFullYear()){e.selectedIndex=n;break}}var r=new Date(this.currentPivotDate);r.setDate(1);var i=r.getFullYear();var s=r.getMonth();var o=32-(new Date(i,s,32)).getDate();var u=new Date(r);var a=r.getDay()-this.firstDayOfWeek;if(a==-1)a=6;for(var n=0;n<o;n++){var f=this.container+u.getFullYear()+"-"+padZero(u.getMonth()+1)+"-"+padZero(u.getDate());var l="content"+f;var c=document.createElement("div");if(u.getDate()==(new Date).getDate()&&u.getMonth()==(new Date).getMonth()&&u.getFullYear()==(new Date).getFullYear()){c.className=WIND.Calendar.monthViewTodayCellClass}else{c.className=WIND.Calendar.monthViewCellClass}c.id=f;var h=document.createElement("div");h.className=WIND.Calendar.dateClass;h.innerHTML=u.getDate();c.appendChild(h);var p=document.createElement("div");p.className=WIND.Calendar.contentCellClass;p.id=l;c.appendChild(p);document.getElementById(this.container+"date"+a).appendChild(c);u.setDate(u.getDate()+1);a++}var d=new Date(r);d.setDate(o);this.activateInteractions()};WIND.Calendar.prototype.initMonthGrid=function(){var e=document.getElementById(this.container);if(e.hasChildNodes()){while(e.childNodes.length>0){e.removeChild(e.firstChild)}}var t=document.createElement("table");t.className=WIND.Calendar.calendarViewClass;var n=document.createElement("tr");var r;for(var i=this.firstDayOfWeek;i<7+this.firstDayOfWeek;i++){r=document.createElement("td");r.className=WIND.Calendar.columnHeadingClass;r.appendChild(document.createTextNode(WIND.Calendar.DAYS[i]));n.appendChild(r)}t.appendChild(n);var s=0;var o=WIND.Calendar.getWeeksInMonth(this.currentPivotDate,this.firstDayOfWeek);var u=Math.floor((100-o)/o);for(var i=0;i<o;i++){n=document.createElement("tr");for(var a=0;a<7;a++){r=document.createElement("td");r.className=WIND.Calendar.calendarViewClass;r.id=this.container+"date"+s;r.style.height=u+"%";r.vAlign="top";n.appendChild(r);s++}t.appendChild(n)}e.appendChild(t)};WIND.Calendar.prototype.initWeekView=function(){this.initWeekNavControl();this.initWeekViewControl();this.updateWeekView()};WIND.Calendar.prototype.initWeekNavControl=function(){var e=document.getElementById(this.container+"navControlDiv");if(e.hasChildNodes()){while(e.childNodes.length>0){e.removeChild(e.firstChild)}}var t=this;var n=document.createElement("input");n.type="button";n.id=this.container+"todayButton";n.value=WIND.Calendar.todayButtonLabel;e.appendChild(n);var r=document.createTextNode(" ");e.appendChild(r);n.onclick=function(){t.currentPivotDate=new Date;t.updateWeekView()};var i=document.createElement("input");i.type="button";i.id=this.container+"prevWeek";i.value=WIND.Calendar.prevButtonLabel;e.appendChild(i);r=document.createTextNode(" ");e.appendChild(r);i.onclick=function(){t.currentPivotDate.setDate(t.currentPivotDate.getDate()-7);t.updateWeekView()};var s=document.createElement("span");s.id=this.container+"weekDuration";e.appendChild(s);t.updateWeekDuration();r=document.createTextNode(" ");e.appendChild(r);var o=document.createElement("input");o.type="button";o.id=this.container+"nextWeek";o.value=WIND.Calendar.nextButtonLabel;e.appendChild(o);o.onclick=function(){t.currentPivotDate.setDate(t.currentPivotDate.getDate()+7);t.updateWeekView()}};WIND.Calendar.prototype.updateWeekDuration=function(){var e=document.getElementById(this.container+"weekDuration");var t=WIND.Calendar.getFirstDateOfWeek(this.currentPivotDate,this.firstDayOfWeek);var n=new Date(t);n.setDate(n.getDate()+6);var r=t.getDate();if(WIND.Calendar.MONTHS[t.getMonth()]!=WIND.Calendar.MONTHS[n.getMonth()]){r+=" ";r+=WIND.Calendar.MONTHS[t.getMonth()]}if(t.getFullYear()!=n.getFullYear()){r+=" ";r+=t.getFullYear()}r+=" - ";r+=n.getDate();r+=" ";r+=WIND.Calendar.MONTHS[n.getMonth()];r+=" ";r+=n.getFullYear();e.innerHTML=r};WIND.Calendar.prototype.initWeekViewControl=function(){var e=document.getElementById(this.container+"viewControlDiv");if(e.hasChildNodes()){while(e.childNodes.length>0){e.removeChild(e.firstChild)}}var t=this;var n=document.createElement("input");n.type="button";n.id=this.container+"weekViewButton";n.value=WIND.Calendar.weekViewButtonLabel;n.disabled=true;e.appendChild(n);var r=document.createTextNode(" ");e.appendChild(r);var i=document.createElement("input");i.type="button";i.id=this.container+"monthViewButton";i.value=WIND.Calendar.monthViewButtonLabel;i.onclick=function(){t.viewMode="month";t.initMonthView()};e.appendChild(i)};WIND.Calendar.prototype.updateWeekView=function(){this.updateWeekDuration();var e=WIND.Calendar.getFirstDateOfWeek(this.currentPivotDate,this.firstDayOfWeek);var t=new Date(e);t.setDate(e.getDate()+6);var n=document.getElementById(this.container);if(n.hasChildNodes()){while(n.childNodes.length>0){n.removeChild(n.firstChild)}}var r=document.createElement("table");r.className=WIND.Calendar.calendarViewClass;var i=document.createElement("tr");var s;for(var o=this.firstDayOfWeek;o<7+this.firstDayOfWeek;o++){s=document.createElement("td");s.className=WIND.Calendar.columnHeadingClass;s.appendChild(document.createTextNode(WIND.Calendar.DAYS[o]));i.appendChild(s)}r.appendChild(i);i=document.createElement("tr");var u=new Date(e);for(var o=0;o<7;o++){var a=this.container+u.getFullYear()+"-"+padZero(u.getMonth()+1)+"-"+padZero(u.getDate());var f="content"+a;s=document.createElement("td");s.className=WIND.Calendar.calendarViewClass;s.style.height="95%";s.vAlign="top";var l=document.createElement("div");l.id=a;if(u.getDate()==(new Date).getDate()&&u.getMonth()==(new Date).getMonth()&&u.getFullYear()==(new Date).getFullYear()){l.className=WIND.Calendar.weekViewTodayCellClass}else{l.className=WIND.Calendar.weekViewCellClass}var c=document.createElement("div");c.className=WIND.Calendar.dateClass;c.innerHTML=u.getDate();l.appendChild(c);var h=document.createElement("div");h.id=f;h.className=WIND.Calendar.contentCellClass;l.appendChild(h);s.appendChild(l);i.appendChild(s);u.setDate(u.getDate()+1)}r.appendChild(i);document.getElementById(this.container).appendChild(r);this.activateInteractions()};WIND.Calendar.getWeeksInMonth=function(e,t){var n=e.getFullYear();var r=e.getMonth();var i=32-(new Date(n,r,32)).getDate();var s=new Date(n,r,1);var o=new Date(n,r,i);var u=WIND.Calendar.getFirstDateOfWeek(s,t);var a=WIND.Calendar.getLastDateOfWeek(o,t);return Math.floor((a-u)/(1e3*60*60*24*7))+1};WIND.Calendar.getFirstDateOfWeek=function(e,t){var n=e.getDay()-t;if(n==-1)n=6;return new Date(e.getFullYear(),e.getMonth(),e.getDate()-n)};WIND.Calendar.getLastDateOfWeek=function(e,t){var n=6+t-e.getDay();if(n==7)n=0;return new Date(e.getFullYear(),e.getMonth(),e.getDate()+n)};WIND.Calendar.prototype.loadXMLFile=function(e){var t=createXHR();t.open("GET",e,false);t.send(null);if(t.status==200){var n=t.responseXML;var r=n.getElementsByTagName("Annotation");for(var i=0;i<r.length;i++){var s=r[i].getAttribute("id");if(s){var o=r[i].getElementsByTagName("CalendarPart");var u=[];for(var a=0;a<o.length;a++){var f=o[a].getAttribute("startTime");var l=o[a].getAttribute("endTime");var c=o[a].getElementsByTagName("event")[0].firstChild.nodeValue;var h=this.createSensiblePart(f,l,c);u.push(h)}if(u.length>0){var p=new WIND.Annotation(r[i].getElementsByTagName("semantics")[0].firstChild.nodeValue,r[i].getElementsByTagName("entity")[0].firstChild.nodeValue,u);this.annotations.push(p)}}}}else{document.getElementById(this.container).innerHTML="Error: "+e+" "+t.status+" "+t.statusText}};WIND.Calendar.prototype.createSensiblePart=function(e,t,n){var r=new WIND.Calendar.Part(e,t,n);r.viewer=this;r.object=this.container+e.substring(0,10);r.setStyle("background-color:#CFDFFE");this.parts.push(r);return r}