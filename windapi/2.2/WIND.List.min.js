WIND.List=function(e,t){this.draggable=false;this.resizable=false;this.top=10;this.left=10;this.width=200;this.height=400;this.color="#3366CC";this.border="#3366CC 2px solid";this.name="List Displayer";this.icon=lib_path+"images/lvizicon.png";this.header=false;this.removable=false;this.configurable=false;if(t.draggable==true)this.draggable=t.draggable;if(t.resizable==true)this.resizable=t.resizable;if(t.header==true)this.header=t.header;if(t.removable==true)this.removable=t.removable;if(t.configurable==true)this.configurable=t.configurable;if(this.draggable==true||this.removable==true||this.configurable==true)this.header=true;var n=document.createElement("div");n.id=e+"Outer";n.style.position="absolute";if(t.top)this.top=t.top;n.style.top=this.top+"px";if(t.left)this.left=t.left;n.style.left=this.left+"px";if(t.width)this.width=t.width;n.style.width=this.width+"px";if(t.height)this.height=t.height;n.style.height=this.height+"px";if(t.color)this.color=t.color;if(t.border)this.border=t.border;n.style.border=this.border;if(t.parentEl)this.parentEl=t.parentEl;if(t.name)this.name=t.name;if(t.icon)this.icon=t.icon;var r;if(document.getElementById(e))r=document.getElementById(e);else{r=document.createElement("div");r.id=e}r.style.position="absolute";r.style.bottom="2px";r.style.overflow="auto";r.style.width="100%";if(this.header)r.style.height="90%";else r.style.height="100%";n.appendChild(r);if(t.parentEl){this.parentEl=t.parentEl;document.getElementById(t.parentEl).appendChild(n)}else document.body.appendChild(n);if(this.header){var i=document.createElement("div");i.id=e+"Handle";i.style.position="absolute";i.style.width="100%";i.style.height="20px";i.style.backgroundColor=this.color;if(this.draggable)i.style.cursor="move";i.style.zIndex=2;var s=document.createElement("img");s.src=this.icon;s.alt="[ ]";s.title="ListDisplayer";s.style.cssFloat="left";i.appendChild(s);var o=document.createElement("span");o.style.color="#FFFFFF";o.style.paddingLeft="3px";o.appendChild(document.createTextNode(this.name));i.appendChild(o);var u=document.createElement("div");u.id=e+"Configuration";u.style.position="absolute";u.style.width="100%";u.style.marginTop="20px";u.style.backgroundColor="#E4E4E4";u.style.zIndex=2;u.style.display="none";n.appendChild(u);var a=document.createElement("span");a.appendChild(document.createTextNode("Name of displayer: "));u.appendChild(a);u.appendChild(document.createElement("br"));var f=document.createElement("input");f.type="text";f.id=e+"Configuration_Name";f.name=e+"Configuration_Name";f.size="30";u.appendChild(f);u.appendChild(document.createElement("br"));var l=document.createElement("input");l.type="button";l.id=e+"Configuration_OK";l.name=e+"Configuration_OK";l.value="OK";u.appendChild(l);this.eventConfigured=new YAHOO.util.CustomEvent("eventConfigured");var c=this;l.onclick=function(){var t=document.getElementById(e+"Configuration_Name").value;if(t!=null&&t!=""){c.name=t;o.removeChild(o.firstChild);o.appendChild(document.createTextNode(c.name))}u.style.display="none";c.eventConfigured.fire(c)};this.eventConfigured.subscribe(this.onConfigure,this,true);var h=document.createElement("input");h.type="button";h.id=e+"Configuration_Cancel";h.name=e+"Configuration_Cancel";h.value="Cancel";u.appendChild(h);h.onclick=function(){u.style.display="none"};if(this.removable){this.eventRemoved=new YAHOO.util.CustomEvent("eventRemoved");var p=document.createElement("img");p.src=lib_path+"images/close.png";p.alt="X";p.title="Delete";p.style.backgroundColor="#EFEFEF";p.style.cssFloat="right";p.style.cursor="pointer";i.appendChild(p);p.onclick=function(){if(confirm("Do you really want to delete it?")){c.destroy();c.eventRemoved.fire(c)}};this.eventRemoved.subscribe(this.onRemove,this,true)}if(this.configurable){var d=document.createElement("img");d.src=lib_path+"images/gear.png";d.alt="*";d.title="Preferences";d.style.cssFloat="right";d.style.marginRight="10px";d.style.cursor="pointer";i.appendChild(d);d.onclick=function(){u.style.display="block"}}n.appendChild(i);if(this.draggable){var v=new YAHOO.util.DD(e+"Outer");v.setHandleElId(e+"Handle");this.eventDragged=new YAHOO.util.CustomEvent("eventDragged");v.on("endDragEvent",function(e){this.eventDragged.fire(this)},this,true);this.eventDragged.subscribe(this.onDrag,this,true);if(t.parentEl){var m=document.getElementById(t.parentEl);var g=n.offsetLeft-m.offsetLeft;var y=m.offsetLeft+m.offsetWidth-n.offsetLeft-n.offsetWidth;var b=n.offsetTop-m.offsetTop;var w=m.offsetTop+m.offsetHeight-n.offsetTop-n.offsetHeight;v.setXConstraint(g,y);v.setYConstraint(b)}else{var g=n.offsetLeft;var b=n.offsetTop;v.setXConstraint(g);v.setYConstraint(b)}}}if(this.resizable){var E=document.createElement("div");E.id="yui-gen0";E.className="yui-resize-handle yui-resize-handle-r";var S=document.createElement("div");S.className="yui-resize-handle-inner-r";E.appendChild(S);n.appendChild(E);var E=document.createElement("div");E.id="yui-gen1";E.className="yui-resize-handle yui-resize-handle-b";var S=document.createElement("div");S.className="yui-resize-handle-inner-b";E.appendChild(S);n.appendChild(E);var E=document.createElement("div");E.id="yui-gen2";E.className="yui-resize-handle yui-resize-handle-br";var S=document.createElement("div");S.className="yui-resize-handle-inner-br";E.appendChild(S);n.appendChild(E);var x=new YAHOO.util.Resize(e+"Outer",{minWidth:10,minHeight:10,maxWidth:1200,maxHeight:800});this.eventResized=new YAHOO.util.CustomEvent("eventResized");x.on("endResize",function(e){this.eventResized.fire(this)},this,true);this.eventResized.subscribe(this.onResize,this,true)}this.container=e;this.groups=[];this.interactionList=[];this.parts=[];this.annotations=[];this.parentDocument=null;this.toolbar=null};WIND.List.prototype.destroy=function(){var e=document.getElementById(this.container+"Outer");if(this.parentEl){var t=[];for(var n=0;n<this.parentDocument.viewers.length;n++){if(this.parentDocument.viewers[n].container!=this.container){t.push(this.parentDocument.viewers[n])}}this.parentDocument.viewers=t;document.getElementById(this.parentEl).removeChild(e)}else document.body.removeChild(e)};WIND.List.prototype.onDrag=function(){this.top=document.getElementById(this.container+"Outer").offsetTop;this.left=document.getElementById(this.container+"Outer").offsetLeft};WIND.List.prototype.onResize=function(){this.width=document.getElementById(this.container+"Outer").offsetWidth;this.height=document.getElementById(this.container+"Outer").offsetHeight};WIND.List.prototype.onConfigure=function(){};WIND.List.prototype.onRemove=function(){};WIND.List.prototype.addToolBar=function(){if(this.toolbar==null){var e=document.createElement("div");e.style.position="absolute";e.style.top="22px";e.style.right="10px";e.style.zIndex="1000";var t=document.createElement("input");t.type="button";t.title="Bold";t.style.height="24px";t.style.width="30px";t.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px 2px";t.style.border="#808080 1px solid";t.style.cursor="pointer";e.appendChild(t);var n=document.createElement("input");n.type="button";n.title="Italic";n.style.height="24px";n.style.width="30px";n.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -34px";n.style.border="#808080 1px solid";n.style.cursor="pointer";e.appendChild(n);var r=document.createElement("input");r.type="button";r.title="Underline";r.style.height="24px";r.style.width="30px";r.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -70px";r.style.border="#808080 1px solid";r.style.cursor="pointer";e.appendChild(r);var i=document.createElement("input");i.type="button";i.title="Strike Through";i.style.height="24px";i.style.width="30px";i.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -106px";i.style.border="#808080 1px solid";i.style.cursor="pointer";e.appendChild(i);var s=document.createElement("input");s.type="button";s.title="Font Color";s.style.height="24px";s.style.width="30px";s.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -214px";s.style.border="#808080 1px solid";s.style.cursor="pointer";e.appendChild(s);var o=document.createElement("input");o.type="button";o.title="Background Color";o.style.height="24px";o.style.width="30px";o.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -286px";o.style.border="#808080 1px solid";o.style.cursor="pointer";e.appendChild(o);document.getElementById(this.container+"Outer").appendChild(e);this.toolbar=e}else this.toolbar.style.visibility="visible"};WIND.List.prototype.removeToolBar=function(){if(this.toolbar!=null)this.toolbar.style.visibility="hidden"};WIND.List.prototype.addAnnotation=function(e){var t=false;for(var n=0;n<e.annotedObjects.length;n++){if(e.annotedObjects.type=="list"){t=true;break}}this.annotations.push(e)};WIND.List.prototype.createAnnotation=function(e,t,n,r,i){var s=this.createSensiblePart(n,r,i);var o=new WIND.Annotation(e,t,s);this.annotations.push(o);return o};WIND.List.prototype.getValue=function(){return{id:this.container,ref:this.ref,rdftype:"http://erozate.iutbayonne.univ-pau.fr/wind#ListComponent",name:this.name,position:{top:this.top,left:this.left},size:{width:this.width,height:this.height},style:{color:this.color,border:this.border,icon:this.icon},annotation:this.annotation,display:this.display,load:this.load,parameter:{draggable:this.draggable?"yes":"no",resizable:this.resizable?"yes":"no",removable:this.removable?"yes":"no",configurable:this.configurable?"yes":"no",header:this.header?"yes":"no",toolbar:"no"}}};WIND.List.prototype.activateInteractions=function(){for(var e=0;e<this.interactionList.length;e++){this.activateInteraction(this.interactionList[e])}};WIND.List.prototype.activateInteraction=function(e){var t=e.source;var n=e.event;var r=e.reactions;var i=this;if(t instanceof Array){for(var s=0;s<t.length;s++){t[s].setStyle("color:blue;text-decoration:underline;cursor:pointer;");this.addListener(t[s].object,n,function(e){for(var t=0;t<r.length;t++){var n=r[t].target;if(n instanceof WIND.LiveSensiblePart){var s=YAHOO.util.Event.getTarget(e);var o;for(var u=0;u<i.parts.length;u++){if(i.parts[u].object==s.id){o=i.parts[u];break}}if(o){var a=n.viewer;var f=n.func;var l=a.annotations;for(var c=0;c<l.length;c++){if(l[c].semantics==o.annotation.semantics&&l[c].entity==o.annotation.entity){if(f=="prefecture_of_town"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Prefecture",n.getElementsByTagName("nom_chf_l")[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#008800,strokeWidth:5,fillColor:#0080AA"});var s=i.annotedObjects;for(var o=0;o<s.length;o++){s[o].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/prefecture_of_town.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else if(f=="prefecture_of_department"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Prefecture",n.getElementsByTagName("nom_chf_l")[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#008800,strokeWidth:5,fillColor:#0080AA"});var s=i.annotedObjects;for(var o=0;o<s.length;o++){s[o].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/prefecture_of_department.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else if(f=="department_of_town"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Department",n.getElementsByTagName("nom_dept")[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#008800,strokeWidth:5,fillColor:#0080AA"});var s=i.annotedObjects;for(var o=0;o<s.length;o++){s[o].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/department_of_town.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else{var p=l[c].annotedObjects;for(var d=0;d<p.length;d++){p[d].callFunction(r[t].calledFunction,r[t].parameters)}}break}}}}else{n.callFunction(r[t].calledFunction,r[t].parameters)}}})}}else{t.setStyle("color:blue;text-decoration:underline;cursor:pointer;");this.addListener(t.object,n,function(e){for(var t=0;t<r.length;t++){var n=r[t].target;if(n instanceof WIND.LiveSensiblePart){var s=YAHOO.util.Event.getTarget(e);var o;for(var u=0;u<i.parts.length;u++){if(i.parts[u].object==s.id){o=i.parts[u];break}}if(o){var a=n.viewer;var f=n.func;var l=a.annotations;for(var c=0;c<l.length;c++){if(l[c].semantics==o.annotation.semantics&&l[c].entity==o.annotation.entity){if(f=="prefecture_of_town"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Prefecture",n.getElementsByTagName("nom_chf_l")[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#008800,strokeWidth:5,fillColor:#0080AA"});var s=i.annotedObjects;for(var o=0;o<s.length;o++){s[o].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/prefecture_of_town.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else if(f=="prefecture_of_department"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Prefecture",n.getElementsByTagName("nom_chf_l")[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#008800,strokeWidth:5,fillColor:#0080AA"});var s=i.annotedObjects;for(var o=0;o<s.length;o++){s[o].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/prefecture_of_department.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else if(f=="department_of_town"){var h=createXHR();h.onreadystatechange=function(){if(h.readyState==4){if(h.status==200){var e=h.responseXML;var n=e.getElementsByTagName("geoname")[0];var i=a.createAnnotation("http://geotopia.univ-pau.fr/GeotopiaService#Department",n.getElementsByTagName("nom_dept")[0].nodeValue,n.getElementsByTagName("astext")[0].textContent,{style:"strokeColor:#008800,strokeWidth:5,fillColor:#0080AA"});var s=i.annotedObjects;for(var o=0;o<s.length;o++){s[o].callFunction(r[t].calledFunction,r[t].parameters)}}}};h.open("GET",lib_path+"php/department_of_town.php?place="+l[c].entity,false);h.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8");h.send(null)}else{var p=l[c].annotedObjects;for(var d=0;d<p.length;d++){p[d].callFunction(r[t].calledFunction,r[t].parameters)}}break}}}}else{n.callFunction(r[t].calledFunction,r[t].parameters)}}})}};WIND.List.prototype.addListener=function(e,t,n){if(document.getElementById(e)){if(t=="click"){document.getElementById(e).onclick=n}else if(t=="mouseover"){document.getElementById(e).onmouseover=n}else if(t=="mouseout"){document.getElementById(e).onmouseout=n}}};WIND.List.prototype.loadRDFFile=function(e,t){var n=createXHR();n.open("GET",e+"?rdf="+t,false);n.send(null);var r=function(e,t){for(var n=0;n<e.length;n++){if(e[n]===t){return true}}return false};if(n.status==200){var i=YAHOO.lang.JSON.parse(n.responseText);var s=i.annotations;var o=new Array;var u=new Array;var a=new Array;for(var f=0;f<s.length;f++){if(s[f].thematicInfo&&s[f].thematicInfo.length>0){for(var l=0;l<s[f].thematicInfo.length;l++){if(!r(o,s[f].thematicInfo[l].category)){o.push(s[f].thematicInfo[l].category);u[s[f].thematicInfo[l].category]=new Array}u[s[f].thematicInfo[l].category].push(s[f].entityName)}}else a.push(s[f].entityName)}for(var f=0;f<o.length;f++){var c=this.createGroup(o[f]);for(var l=0;l<u[o[f]].length;l++){c.addItem(u[o[f]][l])}}if(a.length>0){var c=this.createGroup("Uncategorized");for(var l=0;l<a.length;l++){c.addItem(a[l])}}}else{document.getElementById(this.container).innerHTML="Error: "+t+" "+n.status+" "+n.statusText}};WIND.List.Part=function(e){this.object=e;this.group=null;this.itemId=null;this.word=null};WIND.List.Part.prototype=new WIND.SensiblePart("list");WIND.List.Part.prototype.highlight=function(){var e=document.getElementById(this.object);if(e){e.style.backgroundColor="blue";e.style.color="white"}};WIND.List.Part.prototype.bold=function(){var e=document.getElementById(this.object);if(e){e.style.fontWeight="bold"}};WIND.List.Part.prototype.italicize=function(){var e=document.getElementById(this.object);if(e){e.style.fontStyle="italic"}};WIND.List.Part.prototype.underline=function(){var e=document.getElementById(this.object);if(e){e.style.textDecoration="underline"}};WIND.List.Part.prototype.blink=function(){var e=document.getElementById(this.object);if(e){e.style.textDecoration="blink"}};WIND.List.Part.prototype.setStyleByClass=function(e){var t=document.getElementById(this.object);if(t){t.className=e}};WIND.List.Part.prototype.setStyle=function(e){var t=document.getElementById(this.object);if(t){var n=e.split(";");var r;for(var i=0;i<n.length;i++){r=n[i];if(r.split(":")[0]=="color")t.style.color=r.split(":")[1];if(r.split(":")[0]=="background-color")t.style.backgroundColor=r.split(":")[1];if(r.split(":")[0]=="font-weight")t.style.fontWeight=r.split(":")[1];if(r.split(":")[0]=="font-style")t.style.fontStyle=r.split(":")[1];if(r.split(":")[0]=="text-decoration")t.style.textDecoration=r.split(":")[1];if(r.split(":")[0]=="cursor")t.style.cursor=r.split(":")[1]}}};WIND.List.Part.prototype.show=function(){var e=document.getElementById(this.object);if(e){e.style.display="block"}};WIND.List.Part.prototype.hide=function(){var e=document.getElementById(this.object);if(e){e.style.display="none"}};WIND.List.Group=function(e){this.object=e;this.items=[]};WIND.List.Group.prototype=new WIND.List.Part(this.object);WIND.List.prototype.createGroup=function(e,t){var n=this.groups.length+1;var r=document.createElement("div");r.id=this.container+"_group"+n;r.style.margin="0px 10px 10px 10px";r.style.textAlign="left";if(t){if(t.display)r.style.display="block";else r.style.display="none"}else r.style.display="block";document.getElementById(this.container).appendChild(r);var i=document.createElement("div");i.innerHTML="<b>"+e+"</b>";r.appendChild(i);var s=document.createElement("ul");s.id=this.container+"_groupUL"+n;s.title=e;s.style.margin=0;r.appendChild(s);var o=new WIND.List.Group(this.container+"_groupUL"+n);this.groups.push(o);return o};WIND.List.Group.prototype.setItems=function(e){this.items=e;var t=document.getElementById(this.object);for(var n=0;n<this.items.length;n++){var r=document.createElement("li");r.id=this.object+"_item"+(n+1);r.appendChild(document.createTextNode(this.items[n]));t.appendChild(r)}};WIND.List.Group.prototype.addItem=function(e){this.items.push(e);var t=document.getElementById(this.object);var n=document.createElement("li");n.id=this.object+"_item"+this.items.length;n.appendChild(document.createTextNode(e));t.appendChild(n)};WIND.List.prototype.createSensiblePart=function(e,t,n){var r=this.container+"_groupUL"+e+"_item"+t;var i=new WIND.List.Part(r);i.viewer=this;i.group=e;i.itemId=t;i.word=this.groups[e-1].items[t-1];this.parts.push(i);if(n&&n.style){i.setStyle(n.style)}else{i.setStyle("text-decoration:underline")}return i};WIND.List.prototype.createSensiblePartByWord=function(e,t){var n;var r=[];var i,s;var o=WIND.Text.tokenizer(e);var u;for(var a=0;a<this.paragraphs.length;a++){n=this.paragraphs[a].words;for(var f=0;f<n.length-o.length;f++){u=true;for(var l=0;l<o.length;l++){if(!(n[f+l]==o[l])){u=false;break}}if(u){for(var l=0;l<o.length;l++){i=this.container+"_paragraph"+(a+1)+"_token"+(f+l+1);s=new WIND.Text.Part(i);s.viewer=this;r.push(s);this.parts.push(s)}}}}if(t&&t.style){for(var a=0;a<r.length;a++){r[a].setStyle(t.style)}}else{for(var a=0;a<r.length;a++){r[a].setStyle("color:blue;text-decoration:underline")}}return r}