wind_image=true;WIND.Image=function(e,t){this.draggable=false;this.resizable=false;this.top=10;this.left=10;this.width=800;this.height=400;this.color="#3366CC";this.border="#3366CC 2px solid";this.name="Image Displayer";this.icon=lib_path+"images/lvizicon.png";this.header=false;this.removable=false;this.configurable=false;this.nomiddiv=e;this.collection=[];this.switchBar=false;if(t.draggable==true)this.draggable=t.draggable;if(t.resizable==true)this.resizable=t.resizable;if(t.header==true)this.header=t.header;if(t.removable==true)this.removable=t.removable;if(t.configurable==true)this.configurable=t.configurable;if(this.draggable==true||this.removable==true||this.configurable==true)this.header=true;var n=document.createElement("div");n.id=e+"Outer";n.style.position="absolute";if(t.top)this.top=t.top;n.style.top=this.top+"px";if(t.left)this.left=t.left;n.style.left=this.left+"px";if(t.width)this.width=t.width;n.style.width=this.width+"px";if(t.height)this.height=t.height;n.style.height=this.height+"px";if(t.color)this.color=t.color;if(t.border)this.border=t.border;n.style.border=this.border;if(t.parentEl)this.parentEl=t.parentEl;if(t.name)this.name=t.name;if(t.icon)this.icon=t.icon;var r;if(document.getElementById(e))r=document.getElementById(e);else{r=document.createElement("div");r.id=e}r.style.position="absolute";r.style.bottom="2px";r.style.overflow="auto";r.style.width="100%";if(this.header)r.style.height="90%";else r.style.height="100%";n.appendChild(r);this.textDiv=r;if(t.parentEl){this.parentEl=t.parentEl;document.getElementById(t.parentEl).appendChild(n)}else document.body.appendChild(n);if(this.header){var i=document.createElement("div");i.id=e+"Handle";i.style.position="absolute";i.style.width="100%";i.style.height="20px";i.style.backgroundColor=this.color;if(this.draggable)i.style.cursor="move";i.style.zIndex=2;var s=document.createElement("img");s.src=this.icon;s.alt="[ ]";s.title="ImageDisplayer";s.style.cssFloat="left";i.appendChild(s);var o=document.createElement("span");o.style.color="#FFFFFF";o.style.paddingLeft="3px";o.appendChild(document.createTextNode(this.name));i.appendChild(o);var u=document.createElement("div");u.id=e+"Configuration";u.style.position="absolute";u.style.width="100%";u.style.marginTop="20px";u.style.backgroundColor="#E4E4E4";u.style.zIndex=2;u.style.display="none";n.appendChild(u);var a=document.createElement("span");a.appendChild(document.createTextNode("Name of displayer: "));u.appendChild(a);u.appendChild(document.createElement("br"));var f=document.createElement("input");f.type="text";f.id=e+"Configuration_Name";f.name=e+"Configuration_Name";f.size="30";u.appendChild(f);u.appendChild(document.createElement("br"));var l=document.createElement("input");l.type="button";l.id=e+"Configuration_OK";l.name=e+"Configuration_OK";l.value="OK";u.appendChild(l);this.eventConfigured=new YAHOO.util.CustomEvent("eventConfigured");var c=this;l.onclick=function(){var t=document.getElementById(e+"Configuration_Name").value;if(t!=null&&t!=""){c.name=t;o.removeChild(o.firstChild);o.appendChild(document.createTextNode(c.name))}u.style.display="none";c.eventConfigured.fire(c)};this.eventConfigured.subscribe(this.onConfigure,this,true);var h=document.createElement("input");h.type="button";h.id=e+"Configuration_Cancel";h.name=e+"Configuration_Cancel";h.value="Cancel";u.appendChild(h);h.onclick=function(){u.style.display="none"};if(this.removable){this.eventRemoved=new YAHOO.util.CustomEvent("eventRemoved");var p=document.createElement("img");p.src=tuto_path+"/styles/images/close.png";p.alt="X";p.title="Delete";p.style.backgroundColor="#EFEFEF";p.style.cssFloat="right";p.style.cursor="pointer";i.appendChild(p);p.onclick=function(){if(confirm("Do you really want to delete it?")){c.destroy();c.eventRemoved.fire(c)}};this.eventRemoved.subscribe(this.onRemove,this,true)}if(this.configurable){var d=document.createElement("img");d.src=tuto_path+"/styles/images/icons/gear.png";d.alt="*";d.title="Preferences";d.style.cssFloat="right";d.style.marginRight="10px";d.style.cursor="pointer";i.appendChild(d);d.onclick=function(){u.style.display="block"}}n.appendChild(i);if(this.draggable){var v=new YAHOO.util.DD(e+"Outer");v.setHandleElId(e+"Handle");this.eventDragged=new YAHOO.util.CustomEvent("eventDragged");v.on("endDragEvent",function(e){this.eventDragged.fire(this)},this,true);this.eventDragged.subscribe(this.onDrag,this,true);if(t.parentEl){var m=document.getElementById(t.parentEl);var g=n.offsetLeft-m.offsetLeft;var y=m.offsetLeft+m.offsetWidth-n.offsetLeft-n.offsetWidth;var b=n.offsetTop-m.offsetTop;var w=m.offsetTop+m.offsetHeight-n.offsetTop-n.offsetHeight;v.setXConstraint(g,y);v.setYConstraint(b)}else{var g=n.offsetLeft;var b=n.offsetTop;v.setXConstraint(g);v.setYConstraint(b)}}}if(this.resizable){var E=document.createElement("div");E.id="yui-gen0";E.className="yui-resize-handle yui-resize-handle-r";var S=document.createElement("div");S.className="yui-resize-handle-inner-r";E.appendChild(S);n.appendChild(E);var E=document.createElement("div");E.id="yui-gen1";E.className="yui-resize-handle yui-resize-handle-b";var S=document.createElement("div");S.className="yui-resize-handle-inner-b";E.appendChild(S);n.appendChild(E);var E=document.createElement("div");E.id="yui-gen2";E.className="yui-resize-handle yui-resize-handle-br";var S=document.createElement("div");S.className="yui-resize-handle-inner-br";E.appendChild(S);n.appendChild(E);var x=new YAHOO.util.Resize(e+"Outer",{minWidth:10,minHeight:10,maxWidth:1200,maxHeight:800});this.eventResized=new YAHOO.util.CustomEvent("eventResized");x.on("endResize",function(e){this.eventResized.fire(this)},this,true);this.eventResized.subscribe(this.onResize,this,true)}this.container=e;this.groups=[];this.interactionImage=[];this.parts=[];this.annotations=[];this.parentDocument=null;this.toolbar=null;this.imageId="image"};WIND.Image.prototype.addImage=function(e,t){var n=document.getElementById(this.nomiddiv);var r=this.getCollection(t);r.photos.push(e);var i=document.createElement("img");i.setAttribute("id",this.imageId);i.setAttribute("src",this.collection[0].photos[0]);i.setAttribute("alt",this.collection[0].photos[0]);n.appendChild(i)};WIND.Image.prototype.addImageToCollection=function(e,t){var n=this.getCollection(t);n.photos.push(e)};WIND.Image.prototype.addCollection=function(e){var t={};t.name=e;t.photos=[];t.miniatures=[];t.tags=[];this.collection.push(t)};WIND.Image.prototype.getCollection=function(e){for(var t=0;t<this.collection.length;t++){if(this.collection[t].name==e){return this.collection[t]}}return false};WIND.Image.prototype.addSwitchBar=function(e){if(!this.switchBar){var t=document.createElement("div");t.setAttribute("id",this.switchBarContainer);var n=this.getCollection(e);var r=this;for(var i=0;i<n.photos.length;i++){var s=document.createElement("img");s.setAttribute("src",n.photos[i]);s.setAttribute("alt",n.photos[i]);s.setAttribute("border","5");s.setAttribute("bordercolor","white");s.setAttribute("width","110");s.setAttribute("height","70");s.setAttribute("hspace","10");s.onclick=function(){console.log(this.imageId);var e=document.getElementById(r.imageId);e.setAttribute("src",this.src);e.setAttribute("alt","toto")};t.appendChild(s)}document.body.appendChild(t);this.switchBar=true}};WIND.Image.prototype.brightness=function(e){var t="#image";Caman(t,function(){this.brightness(e).render()})};WIND.Image.prototype.contrast=function(e){var t="#image";Caman(t,function(){this.contrast(e).render()})};WIND.Image.prototype.rotate=function(e){var t="#image";Caman(t,function(){this.rotate(e).render()})};WIND.Image.prototype.kernel=function(e){var t="#image";Caman(t,function(){this.processKernel("Box Blur",e,1,0);this.render()})};WIND.Image.prototype.contourdetect=function(){var e="#image";Caman(e,function(){this.processKernel("Box Blur",[0,1,0,1,-4,1,0,1,0],1,0);this.render()})};WIND.Image.prototype.blur=function(){var e="#image";Caman(e,function(){this.processKernel("Box Blur",[1,1,1,1,1,1,1,1,1],1,0);this.render()})};WIND.Image.prototype.createAnnotation=function(e,t){var n=this.createSensiblePart();var r=new WIND.Annotation(e,t,[n]);this.annotations.push(r);return r};WIND.Image.prototype.destroy=function(){var e=document.getElementById(this.container+"Outer");if(this.parentEl){var t=[];for(var n=0;n<this.parentDocument.viewers.length;n++){if(this.parentDocument.viewers[n].container!=this.container){t.push(this.parentDocument.viewers[n])}}this.parentDocument.viewers=t;document.getElementById(this.parentEl).removeChild(e)}else document.body.removeChild(e)};WIND.Image.prototype.onDrag=function(){this.top=document.getElementById(this.container+"Outer").offsetTop;this.left=document.getElementById(this.container+"Outer").offsetLeft};WIND.Image.prototype.onResize=function(){this.width=document.getElementById(this.container+"Outer").offsetWidth;this.height=document.getElementById(this.container+"Outer").offsetHeight};WIND.Image.prototype.onConfigure=function(){};WIND.Image.prototype.onRemove=function(){};WIND.Image.prototype.addToolBar=function(){if(this.toolbar==null){var e=document.createElement("div");e.style.position="absolute";e.style.top="22px";e.style.right="10px";e.style.zIndex="1000";var t=document.createElement("input");t.type="button";t.title="Bold";t.style.height="24px";t.style.width="30px";t.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px 2px";t.style.border="#808080 1px solid";t.style.cursor="pointer";e.appendChild(t);var n=document.createElement("input");n.type="button";n.title="Italic";n.style.height="24px";n.style.width="30px";n.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -34px";n.style.border="#808080 1px solid";n.style.cursor="pointer";e.appendChild(n);var r=document.createElement("input");r.type="button";r.title="Underline";r.style.height="24px";r.style.width="30px";r.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -70px";r.style.border="#808080 1px solid";r.style.cursor="pointer";e.appendChild(r);var i=document.createElement("input");i.type="button";i.title="Strike Through";i.style.height="24px";i.style.width="30px";i.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -106px";i.style.border="#808080 1px solid";i.style.cursor="pointer";e.appendChild(i);var s=document.createElement("input");s.type="button";s.title="Font Color";s.style.height="24px";s.style.width="30px";s.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -214px";s.style.border="#808080 1px solid";s.style.cursor="pointer";e.appendChild(s);var o=document.createElement("input");o.type="button";o.title="Background Color";o.style.height="24px";o.style.width="30px";o.style.background="url(http://yui.yahooapis.com/2.8.0r4/build/editor/assets/skins/sam/editor-sprite.gif) no-repeat 5px -286px";o.style.border="#808080 1px solid";o.style.cursor="pointer";e.appendChild(o);document.getElementById(this.container+"Outer").appendChild(e);this.toolbar=e}else this.toolbar.style.visibility="visible"};WIND.Image.prototype.removeToolBar=function(){if(this.toolbar!=null)this.toolbar.style.visibility="hidden"};WIND.Image.Part=function(e){this.object=e};WIND.Image.Part.prototype=new WIND.SensiblePart("image");WIND.Image.prototype.createSensiblePart=function(){var imagepart = new WIND.Image.Part(this.imageId); imagepart.viewer = this; return imagepart;};WIND.Image.Part.prototype.rotate=function(){Caman("#"+this.object,function(){this.rotate(90).render()})};WIND.Image.Part.prototype.contrast=function(){Caman("#"+this.object,function(){this.contrast(50).render()})};WIND.Image.Part.prototype.brightness=function(){Caman("#"+this.object,function(){this.brightness(50).render()})};WIND.Image.Part.prototype.contourdetect=function(){Caman("#"+this.object,function(){this.processKernel("Box Blur",[0,1,0,1,-4,1,0,1,0],1,0);this.render()})};WIND.Image.Part.prototype.blur=function(){Caman("#"+this.object,function(){this.processKernel("Box Blur",[1,1,1,1,1,1,1,1,1],1,0);this.render()})};WIND.Image.prototype.imagelocation=function(){document.getElementById("image").onload=function(){EXIF.getData(this,function(){var e=EXIF.getTag(this,"GPSLongitudeRef");var t=EXIF.getTag(this,"GPSLongitude");var n=t+"";var r=EXIF.getTag(this,"GPSLatitude");var i=EXIF.getTag(this,"GPSLagitudeRef");var s=r+"";var o=s.split(",");var u=parseFloat(o[0]);var a=parseFloat(o[1]);var f=parseFloat(o[2]);var l=u+a/60+f/(60*60);if(i=="S"||i=="W"){l=l*-1}var c=n.split(",");var h=parseFloat(c[0]);var p=parseFloat(c[1]);var d=parseFloat(c[2]);var v=h+p/60+d/(60*60);if(e=="S"||e=="W"){v=v*-1}var m=new WIND.Map("map",{top:50});var g=new WIND.Map.Marker(v,l);m.addMarker(g)})}}